<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <link 
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
      rel="stylesheet" 
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" 
      crossorigin="anonymous">
    <script 
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" 
      integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" 
      crossorigin="anonymous">
    </script>
    <title><%= title %></title>
  </head>

<head>
<%- include('./partials/head') -%>
<script>
    function GenerateCaptcha(){
      var num1=Math.floor((Math.random()*10)+1);
      var num2=Math.floor((Math.random()*10)+1);
      var html="Calculate: " + num1 + "+" + num2 + "=:";
      document.getElementById("num1").innerHTML=num1;
      document.getElementById("num2").innerHTML=num2;
      return true;
    }
    function CheckCaptcha(){
        var num1=1*document.getElementById("num1").innerHTML;
        console.log(num1);
        var num2=1*document.getElementById("num2").innerHTML;
        console.log(num2);
        var answer=document.forms["registerform"]["captchanumber"].value;
        console.log(answer);
        if (num1+num2==answer){
            return true;
        }
        else{
            alert("Incorrect Captcha");
            GenerateCaptcha();
            registerform.reset();
            return false;
        }

    }
    </script>
</head>

<body onload="GenerateCaptcha()">
<header>
<%- include('./partials/header') -%>
</header>

      <br />

<form name="registerform" id="registerform" action="/register" onsubmit="return CheckCaptcha()" method="POST">

        <!-- Username input -->
      <div class="form-outline mb-4">
        <label class="form-label" for="registerUsername">Username</label>
        <input
          type="text"
          name="registerUsername"
          id="registerUsername"
          class="form-control"
          pattern="([a-z0-9]){4,16}" 
          required
          />
          <div id="passwordHelpBlock" class="form-text">
            <ul>
              <li>All Lowercase</li>
              <li>Only Letters or Numbers</li>
              <li>4 - 16 Characters.</li>
            </ul>
          </div>
          <div class="invalid-feedback">Example invalid feedback text</div>
        </div>

        <!-- Email input -->
        <div class="form-outline mb-4">
            <label class="form-label" for="registerEmail">Email address</label>
            <input
              type="email"
              name="registerEmail"
              id="registerEmail"
              class="form-control"
              value=""
            />
          </div>

        <!-- Password input -->
        <div class="form-outline mb-4">
          <label class="form-label" for="registerPassword">Password</label>
          <input
            type="password"
            name="registerPassword"
            id="registerPassword"
            class="form-control"
            value=""
          />
        </div>

<div class="form-floating">
<input type="email" class="form-control" id="email" name="email" placeholder="name@example.com" required>
<label for="email">Email address</label>
</div>

        <!-- Submit button -->
        <div class="col d-flex justify-content-center">
          <button type="submit" class="btn btn-primary btn-block mb-4">
            Register
          </button>
        </div>

<div class="form-floating">
    <input type="number" class="form-control" id="captchanumber" name="captchanumber" placeholder=""  maxlength="25"
     required>
    <label for="captchanumber">Calculate <span id="num1"> 1 </span> + <span id="num2"> 2 </span> = </label>
    </div>

<button class="w-100 btn btn-lg btn-primary" type="submit">Register</button>
</form>

        <!-- Change to Login -->
        <div class="text-center">
          <p>Already have an account? <a href="/login">Log in</a></p>
        </div>
      </form>
    </div>
  </body>

  <%- include("./partials/footer.ejs") %> <!-- Footer Partial -->

</html>